(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))d(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const c of t.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&d(c)}).observe(document,{childList:!0,subtree:!0});function s(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function d(e){if(e.ep)return;e.ep=!0;const t=s(e);fetch(e.href,t)}})();const f={P1:{KeyW:"move_up",KeyS:"move_down",KeyA:"move_left",KeyD:"move_right",KeyJ:"shoot"}};function k(o){const i={},s={move_up:()=>{o.move_y_stop(),i.move_down&&o.move_down()},move_down:()=>{o.move_y_stop(),i.move_up&&o.move_up()},move_left:()=>{o.move_x_stop(),i.move_right&&o.move_right()},move_right:()=>{o.move_x_stop(),i.move_left&&o.move_left()}};document.addEventListener("keydown",d=>{if(!f[o.id])return;const e=f[o.id][d.code];i[e]=!0,typeof o[e]=="function"&&o[e]()}),document.addEventListener("keyup",d=>{const e=f[o.id][d.code];i[e]=!1,typeof s[e]=="function"&&s[e]()})}function E(o){const i=o.ctx.canvas;function s(){let d=i.width-o.width,e=i.height-o.height;o.position.x<0?o.position.x=0:o.position.x>d&&(o.position.x=d),o.position.y<0?o.position.y=0:o.position.y>e&&(o.position.y=e)}o.hooks.update.push(s)}function y(o){const i={rate:2e3,y:!1,x:!1};o.decelerate=i;function s(t){d(t),e(t)}function d(t){i.x&&o.velocity.x!==0&&(o.velocity.x>0?(o.velocity.x-=i.rate*t.seconds_passed,o.velocity.x<0&&(o.velocity.x=0)):(o.velocity.x+=i.rate*t.seconds_passed,o.velocity.x>0&&(o.velocity.x=0)))}function e(t){i.y&&o.velocity.y!==0&&(o.velocity.y>0?(o.velocity.y-=i.rate*t.seconds_passed,o.velocity.y<0&&(o.velocity.y=0)):(o.velocity.y+=i.rate*t.seconds_passed,o.velocity.y>0&&(o.velocity.y=0)))}o.hooks.update.push(s)}function L(o){o.move_speed=300,o.direction="right",o.move_up=()=>{o.direction="up",o.decelerate.y=!1,o.velocity.y=-o.move_speed},o.move_down=()=>{o.direction="down",o.decelerate.y=!1,o.velocity.y=o.move_speed},o.move_left=()=>{o.direction="left",o.decelerate.x=!1,o.velocity.x=-o.move_speed},o.move_right=()=>{o.direction="right",o.decelerate.x=!1,o.velocity.x=o.move_speed},o.move_y_stop=()=>{o.decelerate.y=!0},o.move_x_stop=()=>{o.decelerate.x=!0};function i(e){e.strokeRect(o.position.x,o.position.y,o.width,o.height)}function s(e){d(e)}function d(e){o.position.x+=o.velocity.x*e.seconds_passed,o.position.y+=o.velocity.y*e.seconds_passed}o.hooks.draw.push(i),o.hooks.update.push(s),E(o),y(o)}function P(o){const d={up:t,down:c,left:r,right:h};let e={x:0,y:0,w:0,h:0};function t(){e.x=o.position.x+o.width/2-8/2,e.y=o.position.y-16,e.w=8,e.h=16}function c(){e.x=o.position.x+o.width/2-8/2,e.y=o.position.y+o.height,e.w=8,e.h=16}function r(){e.x=o.position.x-16,e.y=o.position.y+o.height/2-8/2,e.w=16,e.h=8}function h(){e.x=o.position.x+o.width,e.y=o.position.y+o.height/2-8/2,e.w=16,e.h=8}function _(){d[o.direction]()}function w(u){u.save(),u.strokeStyle="lightgreen";let{x:m,y:g,w:x,h:b}=e;u.strokeRect(m,g,x,b),u.restore()}o.barrel={coordinates:e},o.hooks.update.push(_),o.hooks.draw.push(w)}class S{constructor(i){this.velocity=i.velocity??800,this.width=i.width??5,this.height=i.height??5,this.direction=i.direction??i.entity.direction,this.position=this.get_initial_position(i)}get_initial_position(i){if(typeof i.position<"u")return i.position;let{x:s,y:d}=i.entity.barrel.coordinates;const e=i.entity.barrel.coordinates.w,t=i.entity.barrel.coordinates.h;return this.direction==="right"?(s+=e,d+=t/2-this.width/2):this.direction==="left"?(s-=this.width,d+=t/2-this.width/2):this.direction==="up"?(s+=e/2-this.width/2,d-=this.height):this.direction==="down"&&(s+=e/2-this.height/2,d+=t),{x:s,y:d}}update(i){let s=this.velocity*i.seconds_passed;this.direction==="right"?this.position.x+=s:this.direction==="left"?this.position.x-=s:this.direction==="up"?this.position.y-=s:this.direction==="down"&&(this.position.y+=s)}draw(i){i.save(),i.strokeStyle="cyan";let{x:s,y:d}=this.position;i.strokeRect(s,d,this.width,this.height),i.restore()}}function O(o){let i={top:0,bottom:o.ctx.canvas.height,right:o.ctx.canvas.width,left:0},s=[];o.shoot=()=>{s.push(new S({entity:o}))};function d(r){(r.position.x<i.left||r.position.x>i.right||r.position.y<i.top||r.position.y>i.bottom)&&e(r)}function e(r){s.splice(s.indexOf(r),1)}function t(r){s.forEach(h=>{h.update(r),d(h)})}function c(r){s.forEach(h=>{h.draw(r)})}o.hooks.update.push(t),o.hooks.draw.push(c)}class K{constructor(i,s){this.ctx=s,this.id=i,this.width=30,this.height=30,this.position={x:200,y:200},this.velocity={x:0,y:0},this.hooks={update:[],draw:[]},L(this),k(this),P(this),O(this)}draw(i){this.hooks.draw.forEach(s=>s(i))}update(i){this.hooks.update.forEach(s=>s(i))}}const l={previous:0,seconds_passed:0};let n,a,p=[];function q(){N(),A(),requestAnimationFrame(v)}window.addEventListener("load",q);function A(){p.push(new K("P1",a))}function R(o){p.forEach(i=>i.update(o))}function F(o){o.clearRect(0,0,n.width,n.height),p.forEach(i=>i.draw(o))}function N(){n=document.querySelector("canvas"),n.width=1e3,n.height=500,a=n.getContext("2d"),a.strokeStyle="green",a.imageSmoothingEnabled=!0,a.imageSmoothingQuality="high"}function v(o){l.seconds_passed=(o-l.previous)/1e3,l.previous=o,R(l),F(a),requestAnimationFrame(v)}
